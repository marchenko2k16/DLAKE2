SECOND TRY TO WRITE CLEANER AND MORE RELIABLE CODE
